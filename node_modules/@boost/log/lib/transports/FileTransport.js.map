{"version":3,"file":"FileTransport.js","sources":["../../src/transports/FileTransport.ts"],"sourcesContent":null,"names":["FileTransport","Transport","constructor","options","path","stream","buffer","draining","lastSize","rotating","Path","resolve","checkFolderRequirements","blueprint","predicates","bool","instance","union","number","string","gzip","maxSize","MAX_LOG_SIZE","positive","required","close","commit","onClose","undefined","once","end","open","createStream","exists","fs","statSync","size","message","write","written","Buffer","byteLength","checkIfNeedsRotation","mkdirSync","parent","recursive","closeStreamAndRotateFile","createWriteStream","encoding","flags","zlib","createGzip","pipe","getRotatedFileName","name","getNextIncrementCount","files","readdirSync","pattern","RegExp","count","forEach","file","match","rotateFile","fileName","renameSync","append"],"mappings":"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"}