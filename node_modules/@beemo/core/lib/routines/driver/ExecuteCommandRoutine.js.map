{"version":3,"file":"ExecuteCommandRoutine.js","sources":["../../../src/routines/driver/ExecuteCommandRoutine.ts"],"sourcesContent":null,"names":["OPTION_PATTERN","ExecuteCommandRoutine","Bind","Routine","blueprint","array","bool","instance","string","additionalArgv","argv","forceConfigOption","packageRoot","tool","required","notNullable","execute","context","options","metadata","primaryDriver","pipeline","createWaterfallPipeline","pipe","msg","gatherArgs","expandGlobs","expandGlobPatterns","filterOptions","filterUnknownOptions","workspaceStrategy","STRATEGY_COPY","copyConfigToWorkspacePackage","useConfigOption","includeConfigOption","bin","runCommandWithArgs","run","captureOutput","stream","args","watchOptions","isWatching","some","option","startsWith","getRiskyOption","replace","params","includes","outHandler","chunk","outStream","write","String","errHandler","errStream","wait","stdout","BatchStream","on","stderr","strategy","getOutputStrategy","debug","configPaths","forEach","config","fs","copyFileSync","path","Path","name","nextArgv","arg","isGlob","paths","glob","sync","cwd","onlyDirectories","onlyFiles","map","color","mute","length","join","push","extractNativeOptions","driver","env","getSupportedOptions","nativeOptions","Promise","resolve","executeCommand","helpOption","split","preferLocal","matches","match","slice","filteredArgv","unknownArgv","filterArgs","allow","getDriverArgs","getCommandLineArgs","getAdditionalArgs","merge","parse","loose","invariant","getArgs","prevArgv","configPath","findConfigByName","configName","configOption","workUnit","symbol","filePath","onBeforeExecute","emit","result","wrap","formatExecReturn","processSuccess","onAfterExecute","error","fail","message","processFailure","onFailedExecute","exitCode","signal","ExitError","extractErrorMessage","trim"],"mappings":"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"}