{"version":3,"file":"Tool.js","sources":["../src/Tool.ts"],"sourcesContent":null,"names":["Tool","Memoize","Bind","Contract","constructor","options","config","context","errStream","outStream","package","argv","configManager","cwd","debug","driverRegistry","msg","project","onResolveDependencies","Event","onRunCreateConfig","onRunDriver","onRunScaffold","onRunScript","scriptRegistry","Path","create","createDebugger","require","version","createTranslator","__dirname","resourcePaths","Registry","resolver","resolveForPnP","validate","Driver","Script","Project","Config","projectName","blueprint","array","instance","string","union","notNullable","notEmpty","process","camelCase","bootstrap","loadConfigFromRoot","getPackage","loadMany","drivers","tool","scripts","bootstrapConfigModule","module","bootstrapModule","root","getConfigModuleRoot","PathResolver","lookupFilePath","lookupNodeModule","resolvedPath","resolve","requireModule","default","isFunction","invariant","Error","color","moduleName","rootPath","parent","filePath","cleanupOnFailure","error","Array","isArray","configPaths","forEach","fs","removeSync","path","createConfigurePipeline","args","driverNames","prepareContext","ConfigContext","length","getAll","driver","addDriverDependency","push","getName","driverName","get","join","emit","WaterfallPipeline","pipe","ResolveConfigsRoutine","createRunDriverPipeline","parallelArgv","DriverContext","getVersion","RunDriverRoutine","name","metadata","title","CleanupConfigsRoutine","skip","configure","cleanup","createRunScriptPipeline","scriptName","match","KEBAB_PATTERN","ScriptContext","RunScriptRoutine","createScaffoldPipeline","generator","action","ScaffoldContext","ScaffoldRoutine","id","rootRequire","createRequire","append","moduleRequire","configModuleRoot","workspaceRoot","workspaces","getWorkspaceGlobs","processObject","Object","defineProperties","beemo","configurable","enumerable","value"],"mappings":"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"}